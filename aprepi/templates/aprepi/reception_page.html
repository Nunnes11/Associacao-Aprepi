{% extends 'aprepi/base_complete.html' %}
{% load static %}

{% block body_class %}bg-page{% endblock %}

{% block content %}


<!-- HTML para a se√ß√£o principal -->
<main class="main-content" style="padding-top: 100px;">
  <div class="container"> <!-- üîπ Novo container pai -->

    {% if carousel_images %}
    <section class="section carousel-section">
      <div id="receptionCarousel" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
          {% for image in carousel_images %}
          <div class="carousel-item{% if forloop.first %} active{% endif %}">
            <img src="{{ image.url }}" class="d-block w-100" alt="{{ image.alt }}" />
          </div>
          {% endfor %}
        </div>

        {% if carousel_images|length > 1 %}
        <div class="carousel-indicators">
          {% for image in carousel_images %}
          <button type="button" data-bs-target="#receptionCarousel" data-bs-slide-to="{{ forloop.counter0 }}" class="{% if forloop.first %}active{% endif %}" {% if forloop.first %}aria-current="true"{% endif %} aria-label="Slide {{ forloop.counter }}"></button>
          {% endfor %}
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#receptionCarousel" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Anterior</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#receptionCarousel" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Pr√≥ximo</span>
        </button>
        {% endif %}
      </div>
    </section>
    {% endif %}

    <!-- Not√≠cias Recentes -->
    <section class="section news-section">
      <h2 class="section-title">Not√≠cias Recentes</h2>

      <div class="row">
        {% for new in news %}
        <div class="col-md-4 col-lg-3 mb-4"> <!-- üîπ Agora usando colunas Bootstrap -->
          <article class="card news-card h-100" aria-labelledby="news-{{ new.id }}">
            <a href="{% url 'new_detail' new.id %}" class="card-image-link" title="{{ new.title }}">
              {% if new.image %}
              <img src="{{ new.image.url }}" alt="{{ new.title }}" class="card-img-top" />
              {% else %}
              <img src="{% static 'img/default-news.png' %}" alt="Sem imagem" class="card-img-top" />
              {% endif %}
            </a>

            <div class="card-body">
              <h3 id="news-{{ new.id }}" class="card-title">{{ new.title|truncatechars:60 }}</h3>
              <p class="card-text">{{ new.text|truncatechars:120 }}</p>

              <a href="{% url 'new_detail' new.id %}" class="btn btn-primary btn-sm">Ler not√≠cia</a>
            </div>
          </article>
        </div>
        {% empty %}
        <p class="text-muted">Ainda n√£o h√° not√≠cias publicadas.</p>
        {% endfor %}
      </div>

      <div class="text-center">
        <a href="{% url 'news_list' %}" class="btn btn-outline-primary">Ver tudo</a>
      </div>
    </section>

    <!-- Depoimentos -->
    <section class="section testimonials-section mt-5">
      <h2 class="section-title">Depoimentos</h2>

      <div class="row">
        {% for t in testimonials %}
        <div class="col-md-4 col-lg-3 mb-4">
          <article class="card testimonial-card text-center h-100">
            {% if t.image and t.image.url %}
            <img src="{{ t.image.url }}" alt="Foto de {{ t.name }}" class="card-img-top" />
            {% else %}
            <img src="{% static 'img/avatar.png' %}" alt="Avatar padr√£o" class="card-img-top" />
            {% endif %}

            <div class="card-body">
              <h3 class="card-title">{{ t.name }}</h3>
              <p class="small text-muted">Idade: {{ t.age }} ‚Äî {{ t.city }}</p>
              <a href="{% url 'testimonial_detail' t.id %}" class="btn btn-primary btn-sm">Ver depoimento</a>
            </div>
          </article>
        </div>
        {% empty %}
        <p class="text-muted">Nenhum depoimento dispon√≠vel.</p>
        {% endfor %}
      </div>

      <div class="text-center">
        <a href="{% url 'testimonials_list' %}" class="btn btn-outline-primary">Ver tudo</a>
      </div>
    </section>

    <!-- Campo para deixar um depoimento -->
    <section class="section cta-section">
      <p class="cta-text">Paciente amigo(a), caso queira deixar seu depoimento sobre a APREPI:</p>
      <a href="{% url 'create_testimonial' %}" class="cta-btn">Clique aqui</a>
    </section>

  </div> <!-- üîπ Fim do container -->
</main>

{% endblock content %}